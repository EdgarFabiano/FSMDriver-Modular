\section{The FSM Driver}
The proposal for controlling the car is a \emph{Finite State Machine}, which
enables a modular development, ideal for teamwork, and separates behaviors, reducing
the effort necessary to evolve a complete controller by breaking this problem into
evolving each state.

FSMs have been one of the favorite instruments f'or AI gaming, and they are present 
in many digital games~\cite{buckland2005}, due to characteristics as follows:

\begin{itemize}
	\item \textbf{Readiness}: a FSM is quickly and simply implemented, in almost every one of its forms.
	
	\item \textbf{Modularity}: debugging and refactoring a FSM becomes a catalyzed processe due to the abstraction of its
	structure, that is, its behavior can be divided into smaller, independent parts, which can be treated separately
	in a way that reduces the effort.
	
	\item \textbf{Low computational complexity}: a FSM would hardly ever require great amounts of processor time, and
	that is because its operation mainly follows but hard-coded rules.
	
	\item \textbf{Intuitive behavior}: analyzing a FSM is an easy process because human minds are often used to
	categorizing situations and conditions of conduct. This characteristic is both a good employment for debugging in
	real time and for turning the pilot's behavior simple enough so that a common person, i.e. non-programmer, could
	identify mistakes and spectate a race understanding the development of the pilot.
	
	\item \textbf{Flexibility}: a fundamental quirk of a FSM, one which makes the process of expanding the scope of the
	structure easier in a level hardly other choice of method would provide. If a new situation occurs, one that was
	not foreseen by the states defined and also one that could not be inserted in any of them, the mere creation of a
	new state would solve the matter, in about no time and almost without interference in the other parts of the whole.
\end{itemize}

	The division of states for the FSMDriver itself are in agreement with the advantages of a FSM, meaning that the choice of
	which states to be used relied on the human intuition of the development of a car in operation. The states designed are:

\begin{figure}[!t]
	\centering
	\includegraphics[width=3in]{StatesDiagram}
	\caption{State transition diagram.}
	\label{fig_sim}
\end{figure}

\begin{itemize}
	\item \textbf{Straight line}: The state in which the pilot commands the car to full throttle and maximum 
	speed/acceleration ahead, and occurs when the car is located in a situation that sees no turning nearby;
	
	\item \textbf{Curve}: Situations focused on the steering of the car, that is, changing its direction of movement
	in order to keep it inside the delimitations of the proper racing space and also to avoid crashing the car into
	an obstacle;
	
	\item \textbf{Out of track}: When the previous states fail to prevent the car from entering an undesired situation
	such as going outside of the track, where conditions such as friction are much worse for the car than inside the
	track, this state takes control of the car and tries to return it to the race;
	
	\item \textbf{Stuck}: In a worst case scenario, when the car is barely moving, drastic measures need to be taken,
	such as reversing the car and steering it out of an obstacle. The appearence of such events reduce largely the
	performance of the pilot in the race.
\end{itemize}

	In other words, the pilot will encounter four situations in a race, two of them are desired, whereas the other two are 
	emergency actions. While the car is either on a \emph{straight line} or on a \emph{curve}, the behavior is normal; 
	but when the criteria defined to manipulate the pilot into entering those states fails to keep it racing, and the car 
	goes \emph{outside of the track} or gets \emph{stuck}, the car encounters troubles and loses performance. That is why
	the accurate definition of the requirements the pilot has to fulfill to be in each of these states needs to be thought 
	thoroughly for good and competitive results.

Each state of the FSMDriver uses specific parameters for defining its behavior. 
There is a transition function that uses specific (constant) parameters to decide 
when state must change (and which state to change to). This function mainly uses four constants:
\begin{itemize}
\item MAX\_SPEED\_DIST, the maximum distance for recognizing a curve.
\item LEFT\_EDGE, track position value that indicate the left boundary of the track.
\item RIGHT\_EDGE, track position value that indicate the right boundary of the track
\item STUCK\_TICKS, number of ticks required to leave the stuck state.
\end{itemize}